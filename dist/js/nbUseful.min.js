!function(a){a.module("nbUseful",["ngStorage"])}(angular),function(a){a.module("nbUseful").directive("collapse",[function(){return{restrict:"A",link:function(a,b,c){var d=b[0],e=function(){return d.offsetHeight},f=function(){var a=e();b.style.height="auto";var c=e();return b.style.height=a+"px",e(),c};a.$watch(c.collapse,function(a){setTimeout(function(){var c=a?0:f();b.style.height=c+"px",b.toggleClass("collapsed",a)},0)})}}}])}(angular),function(a){a.module("nbUseful").directive("sidenavPushIn",function(){return{restrict:"A",require:"^mdSidenav",link:function(b,c,d,e){var f=a.element(document.body);f.addClass("md-sidenav-push-in");var g=(c.hasClass("md-sidenav-left")?"md-sidenav-left":"md-sidenav-right")+"-open",h=function(a){f[a?"addClass":"removeClass"](g)};a.forEach(["open","close","toggle"],function(a){var b=e[a];e[a]=function(){var a=b.apply(e,arguments);return h(e.isOpen()),a}})}}}).directive("sidenavPushInTarget",function(){return{restrict:"A",link:function(a,b){b.addClass("md-sidenav-push-in-target")}}})}(angular),function(a){a.module("nbUseful").directive("srcLoader",function(){return{restrict:"A",link:function(b,c,d){var e,f,g=a.element("<div></div>").addClass("src-loader").insertBefore(c);c.appendTo(g),f=function(){g.addClass("src-loading").removeClass("src-loaded"),e=new Image,e.onload=function(){c[0].src=d.nbSrcLoader,g.addClass("src-loaded").removeClass("src-loading")},e.src=d.nbSrcLoader},""!=d.nbSrcLoader?f():g.addClass("src-empty"),b.$watch(function(){return d.nbSrcLoader},function(a,b){b!==a&&f()})}}})}(angular),function(a){a.module("nbUseful").filter("nl2br",function(){return function(a){return"string"==typeof a?a.replace(/\n/g,"<br />"):a}})}(angular),function(a){a.module("nbUseful").filter("numberFormat",function(){return function(a,b,c,d){if(a=parseFloat(a),isNaN(a))return"";for(var e=b||2,f=c||".",g=d||"",h=Math.floor(a),i=(a%1).toFixed(2),j=Math.floor(i*Math.pow(10,e)),k=(h+"").split("").reverse(),l=[],m=1,n=0;n<k.length;n++)l.push(k[n]),m++,m>3&&(l.push(g),m=1);return l.reverse().join("")+(e>0?f+j:"")}})}(angular),function(a){a.module("nbUseful").filter("trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}])}(angular),function(a){a.module("nbUseful").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized",loginRequest:"auth-login-request"}).constant("ACCOUNT_ROLES",{all:"*",admin:"admin",user:"user",guest:"guest"}).service("$authDefaults",function(){this.url={login:"",logout:"",register:""},this.session={duration:43200}}).factory("$authService",["$http","$rootScope","$authDefaults","AUTH_EVENTS","AuthAccount","$localStorage",function(b,c,d,e,f,g){var h={};return h.data=function(){return f.data()},h.updateExpiration=function(){g.authExpirationDate=new Date},h.checkExpiration=function(){if(void 0!=g.authExpirationDate&&h.isAuthenticated()){var a=new Date(g.authExpirationDate),b=new Date;(b.getTime()-a.getTime())/1e3>=d.session.duration&&(h.logout(),c.$broadcast(e.sessionTimeout))}h.updateExpiration()},h.login=function(a){return b.post(d.url.login,a).then(function(b){return b.data.success&&(f.data(b.data.account),c.$broadcast(e.loginSuccess,b.data.account,a)),b.data},function(a){c.$broadcast(e.loginFailed)})},h.register=function(a){return b.post(d.url.register,a).then(function(b){return b.data.success&&(f.data(b.data.account),c.$broadcast(e.loginSuccess,b.data.account,a)),b.data},function(){c.$broadcast(e.loginFailed)})},h.logout=function(){return b.post(d.url.logout).then(function(){f.destroy(),c.$broadcast(e.logoutSuccess)})},h.isAuthenticated=function(){return!!f.data().id},h.isAuthorized=function(b){return a.isArray(b)||(b=[b]),h.isAuthenticated()&&-1!==b.indexOf(f.data().role)},h}]).service("AuthAccount",["$sessionStorage",function(a){this.data=function(b){return b&&(a.authData=b),void 0!=a.authData&&""!=a.authData?a.authData:{}},this.destroy=function(){a.authData={}}}]).factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS",function(a,b,c){return{responseError:function(d){return a.$broadcast({401:c.notAuthenticated,403:c.notAuthorized,419:c.sessionTimeout,440:c.sessionTimeout}[d.status],d),b.reject(d)}}}])}(angular),function(a){a.module("nbUseful").constant("CACHER_ENGINE",{local:"cacher-engine-local",session:"cacher-engine-session"}).factory("$cacher",["$interval","CACHER_ENGINE","$localStorage","$sessionStorage",function(b,c,d,e){var f={},g=e,h=c.session,i=function(f,g){var i,j=f,k="cacheRequestData_"+j,l={_1:null,_2:null},m=a.extend({interval:30,engine:h},g),n=m.engine==c.local?d:e,o=n.cacheRequestLastUpdate;o?o=new Date(o):(o=new Date,n.cacheRequestLastUpdate=o),this.source=function(a,b,c){l={_1:a,_2:b,_3:c}},this.start=function(a){this.load(),b(function(){this.load()}.bind(this),a||m.interval)},this.stop=function(){b.cancel(i)},this.storage=function(a){return void 0==a?n[k]:void(null!==a?(n[k]=a,o=new Date,n.cacheRequestLastUpdate=o):this.clearStorage())};var p=function(a){return void 0==a?this.storage():(this.storage(a),void("function"==typeof l._3&&l._3.apply(null)))}.bind(this);this.clearStorage=function(){delete n[k],o=new Date,n.cacheRequestLastUpdate=o},this.reload=function(){var b=[p];a.forEach(arguments,function(a){b.push(a)}),l._1.apply(null,b)},this.load=function(){var b=new Date,c=Math.ceil(Math.abs(b.getTime()-o.getTime())/1e3),d=this.storage(),e=[];c<m.interval&&d?e.push(d):e.push(p),a.forEach(arguments,function(a){e.push(a)}),c<m.interval&&d?"function"==typeof l._2&&(l._2.apply(null,e),"function"==typeof l._3&&l._3.apply(null)):"function"==typeof l._1&&l._1.apply(null,e)},this.refresh=function(){this.load(arguments)},this.destroy=function(){n[f]>-1&&(this.stop(),delete n[k],delete n[f])}};return{changeEngine:function(a){a==c.local?(g=d,h=c.local):(g=e,h=c.session)},get:function(a){var b=null;return void 0!=f[a]&&(b=f[a]),b},exists:function(a){return 0!=this.get(a)},init:function(a,b){if(void 0==a||""==a)throw"Unique id must be provided!";var c=this.get(a);return c||(c=new i(a,b),f[a]=c),c},remove:function(a){var b=this.get(a);b||b[a].destroy()},removeAll:function(){a.forEach(f,function(a,b){f[b].destroy()}),f={}},storage:{set:function(a,b){g[a]=b},get:function(a){return g[a]},remove:function(a){delete g[a]}}}}])}(angular),function(a){a.module("nbUseful").factory("$device",[function(){return{os:function(){return"iPad"==navigator.userAgent.match(/iPad/i)?"iPad":"iPhone"==navigator.userAgent.match(/iPhone/i)?"iPhone":"Android"==navigator.userAgent.match(/Android/i)?"Android":"BlackBerry"==navigator.userAgent.match(/BlackBerry/i)?"BlackBerry":"null"}}}])}(angular),function(a){a.module("nbUseful").factory("$popup",["$timeout",function(b){var c={backdrop:function(c){var d=function(c){var d=a.extend({cssClass:"",scroll:!1,clickClose:!0},c||{}),e=!1,f=a.element("body"),g={root:a.element("<div></div>").addClass("popup-overlay fade")};g.root.hide(),g.root.addClass("string"==typeof d.cssClass?d.cssClass:d.cssClass.join(" ")),d.clickClose&&g.root.click(function(a){a.preventDefault(),this.hide()}.bind(this)),this.show=function(){e=!0,g.root.appendTo(f),d.scroll||f.addClass("popup-open"),g.root.show().addClass("in")},this.hide=function(a){e=!1,f.removeClass("popup-open"),g.root.removeClass("in"),b(function(){g.root.detach()},200),a===!0&&delete this},this.isVisible=function(){return e},this.elements=function(){return g},this.destroy=function(){this.hide(!0)}};return new d(c)},loader:function(d){var e=function(d){var e=a.extend({message:"",backdrop:{},cssClass:""},d||{}),f=!1,g=null,h=a.element(window),i=function(){f&&k.dialog.css({marginTop:h.height()/2-k.dialog.height()/2})},j=function(a){""!=a?k.message.html(a).removeClass("ng-hide"):k.message.addClass("ng-hide").html("")},k={root:a.element("<div></div>").addClass("popup-loader fade")};k.dialog=a.element("<div></div>").addClass("popup-loader-dialog").appendTo(k.root),k.animation=a.element("<div></div>").addClass("animation").appendTo(k.dialog),k.message=a.element("<div></div>").addClass("message").appendTo(k.dialog),k.root.hide(),k.root.addClass("string"==typeof e.cssClass?e.cssClass:e.cssClass.join(" ")),e.backdrop!==!1&&(g=c.backdrop(a.extend(e.backdrop,{clickClose:!1}))),h.resize(i),this.message=function(a){return void 0!=a?(j(a),this):(j(e.message),k.message.html())},this.show=function(a){return f=!0,g&&g.show(),k.root.appendTo("body"),this.message(a),k.root.show().addClass("in"),i(),this},this.hide=function(a){return f=!1,g&&g.hide(a),k.root.removeClass("in"),b(function(){k.root.detach()},200),a===!0&&delete this,this},this.isVisible=function(){return f},this.elements=function(){return k},this.destroy=function(){this.hide(!0)}};return new e(d)},modal:function(d){var e=function(d){var e=a.extend({title:"",template:"",close:"Zamknij",backdrop:{},cssClass:"",backdropClose:!0,delay:0},d||{}),f=!1,g=null,h=a.element(window),i=null,j=function(a){if(f){void 0!=a&&a===!1||k();var b=(l.root.outerHeight(!0)-l.root.height())/2,c=h.height()/2-l.dialog.outerHeight(!0)/2-b;0>c&&(c=0),l.dialog.css({marginTop:c})}},k=function(){var a=h.height(),b=l.dialog.outerHeight(!0);if(l.dialog.removeClass("loading"),b>a){var c=a;c-=l.root.outerHeight(!0)-l.root.height(),c-=parseFloat(l.dialog.css("padding-top")),c-=parseFloat(l.dialog.css("padding-bottom")),c-=l.header.outerHeight(!0),c-=l.template.outerHeight(!0)-l.template.height(),c-=l.buttons.outerHeight(!0),l.template.addClass("scroll").height(c)}else l.template.removeClass("scroll").height("auto");j(!1)},l={root:a.element("<div></div>").addClass("popup-modal fade")};l.dialog=a.element("<div></div>").addClass("popup-modal-dialog").appendTo(l.root),l.header=a.element("<div></div>").addClass("header clearfix").appendTo(l.dialog),l.title=a.element("<div></div>").addClass("title").appendTo(l.header),l.close=a.element('<a href="#"><i class="glyphicon glyphicon-remove"></i></a>').addClass("close").appendTo(l.header),l.template=a.element("<div></div>").addClass("content").appendTo(l.dialog),l.buttons=a.element("<div></div>").addClass("buttons").appendTo(l.dialog),l.root.hide(),l.root.addClass("string"==typeof e.cssClass?e.cssClass:e.cssClass.join(" ")),l.close.attr("title",e.close),e.backdrop!==!1&&(g=c.backdrop(a.extend(e.backdrop,{clickClose:!1}))),e.backdrop!==!1&&e.backdropClose&&l.root.click(function(a){a.target==l.root[0]&&this.hide()}.bind(this)),l.close.click(function(a){a.preventDefault(),this.hide()}.bind(this)),h.resize(j),this.title=function(a){return void 0!=a?(""!=a?l.title.html(a):l.title.html("&nbsp;"),this):l.title.html()},this.template=function(a){return void 0!=a?a===!0?l.template.contents():("string"==typeof a?l.template.html(a):"function"==typeof a?f&&(l.dialog.addClass("loading"),a.call(this,l.template,k)):"object"==typeof a&&(l.template.contents().remove(),a.appendTo(l.template)),this):l.template.html()},this.buttons=function(b){return l.buttons.children().remove(),void 0!=b?(l.buttons.removeClass("ng-hide"),a.forEach(b,function(b,c){var d=a.element("<button></button>").text(c).addClass("btn btn-default btn-sm").appendTo(l.buttons);d.click(function(a){a.preventDefault(),b.call(this,d)}.bind(this)),e.button&&"function"==typeof e.button&&e.button.call(this,d,c)}.bind(this))):l.buttons.addClass("ng-hide"),this},this.show=function(){f=!0,l.root.appendTo("body"),g&&g.show();var c=a.extend({},e);2==arguments.length?(this.template(arguments[0]),"string"==typeof arguments[1]?this.title(arguments[1]):"object"==typeof arguments[1]&&(c=a.extend({},e,arguments[1]||{}),this.title(c.title)),this.buttons(c.buttons)):1==arguments.length?("string"==typeof arguments[0]?this.template(arguments[0]):"object"==typeof arguments[0]&&(c=a.extend({},e,arguments[0]||{}),this.template(c.template)),this.title(c.title),this.buttons(c.buttons)):(this.title(c.title),this.template(c.template),this.buttons(c.buttons)),l.root.show(),j(),l.root.addClass("in");var d=l.buttons.children();return d.length>0?d.last().focus():l.close.focus(),c.delay>0&&(i=b(function(){b.cancel(i),this.hide()}.bind(this),c.delay)),this},this.hide=function(a){return f=!1,g&&g.hide(a),l.root.removeClass("in"),b(function(){null!=i&&b.cancel(i),l.root.detach()},200),a===!0&&(h.unbind("resize",j),delete this),this},this.isVisible=function(){return f},this.elements=function(){return l},this.destroy=function(){this.hide(!0)}};return new e(d)},dialog:function(a){if(a)void 0!=a.cssClass?"string"==typeof a.cssClass?a.cssClass="popup-dialog "+a.cssClass:"object"==typeof a.cssClass&&a.cssClass.unshift("popup-dialog"):a.cssClass="popup-dialog";else var a={cssClass:"popup-dialog"};return c.modal(a)},zendform:function(b){var d=c.dialog(b),e=d.show;return d.show=function(b){var c="";if(b)if(b.message&&""!=b.message)c=b.message;else if(a.isArray(b)){var d=[];a.forEach(b,function(a){d.push(a)}),c=d.join("<br />")}else if(b.errors){var d=[];a.forEach(b.errors,function(b){a.forEach(b,function(a){d.push(a)})}),c=d.join("<br />")}e.call(this,c)},d}};return c}])}(angular);